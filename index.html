<!doctype html>
<html ng-app="musicology">
<head>
  <meta charset="utf-8">
  <title>Musicology</title>
  <link rel="stylesheet" href="app.css"/>
</head>
<body>

  <div ng-controller="AnalyserCtrl" ng-init="audioContext.analyse()">
    Sample rate: {{audioContext.getSampleRate()}},
    FFT size: {{audioContext.getFftSize()}},
    Frequency bins: {{audioContext.getFrequencyBinCount()}}<br/>
    <br/>
    <div class="toneGenerator" ng-repeat="generatorId in [0, 1, 2]">
      <div class="control" ng-controller="GeneratorCtrl" ng-init="init(generatorId)">
        <p>Tone generator {{generatorId}}</p>
        Buffer size: {{generator.getBufferSize()}},
        duration: {{generator.getBufferDuration().toFixed(3)}} sec<br/>
        <label>Function</label><br/>
        <input type="radio" ng-model="generator.functionName" value="sine" ng-change="updateFunction()">Sine
        <input type="radio" ng-model="generator.functionName" value="triangle" ng-change="updateFunction()">Triangle
        <input type="radio" ng-model="generator.functionName" value="square" ng-change="updateFunction()">Square
        <br/>

        Frequency: <input type="text" ng-model="generator.frequency" ng-change="updateFunction()"/>
        <br/>
        <button name="playButton" ng-click="play()">Play</button>
        <button name="stopButton" ng-click="stop()">Stop</button>
        {{isPlaying()}}<br/>
      </div>

      <canvas class="waveform" id="waveformCanvas{{generatorId}}" width="400" height="200"></canvas>
      <!--
      <p>Raw data</p>
      <p>
        <span ng-repeat="(k, v) in generator.samples">{{k}}: {{v}} </span>
      </p>
      -->
      <div class="clearfix"></div>
    </div>

    <div class="clearfix"></div>

    <hr/>
    <label>Spectrum</label><br/>
    Bucket width: {{}}<br/>

    Analyser smoothing:
    <input type="text" ng-model="smoothing" ng-change="setSmoothing()"/>&nbsp;

    Floor:
    <input type="text" size="4" ng-model="audioContext.analyserFloor"/>db

    <input type="checkbox" ng-model="audioContext.showAnalysis"/>Show analysis<br/>

    <canvas id="spectrumCanvas" width="1024" height="256"></canvas>
    <!--
    <p>Raw data</p>
    <p>
      <span ng-repeat="(k, v) in spectrum">{{k}}: {{v}} </span>
    </p>
    -->

    <hr/>

    

  </div>
 
  <script src="lib/angular-1.0.0rc1.js"></script>
  <script src="js/services.js"></script>
  <script src="js/controllers.js"></script>
</body>
</html>

